<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4 Pics 1 Word - Capiz Edition (15 Rounds)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f0f4f8;
        }
        .image-placeholder {
            background-color: #e2e8f0;
            color: #4a5568;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-weight: 600;
            padding: 0.5rem;
            background-size: cover;
            background-position: center;
            transition: transform 0.3s ease;
        }
        .image-placeholder:hover {
            transform: scale(1.05);
        }
        .letter-btn, .answer-box {
            transition: all 0.2s ease-in-out;
        }
        .letter-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
        }
        .correct {
            animation: tada 1s ease;
        }
        .incorrect {
            animation: shake 0.5s ease;
        }
        .hint-revealed {
            background-color: #d1fae5 !important; /* A light green to show it's a hint */
            color: #065f46 !important;
            cursor: not-allowed;
        }
        @keyframes tada {
            from { transform: scale3d(1, 1, 1); }
            10%, 20% { transform: scale3d(0.9, 0.9, 0.9) rotate3d(0, 0, 1, -3deg); }
            30%, 50%, 70%, 90% { transform: scale3d(1.1, 1.1, 1.1) rotate3d(0, 0, 1, 3deg); }
            40%, 60%, 80% { transform: scale3d(1.1, 1.1, 1.1) rotate3d(0, 0, 1, -3deg); }
            to { transform: scale3d(1, 1, 1); }
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 1rem;
            text-align: center;
            box-shadow: 0 10px 25px -5px rgba(0,0,0,0.1), 0 10px 10px -5px rgba(0,0,0,0.04);
            animation: slide-in 0.3s ease-out;
        }
        @keyframes slide-in {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>
<body class="bg-slate-100 flex items-center justify-center min-h-screen p-4">

    <audio id="background-audio" src="https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic.mp3" loop autoplay></audio>
    <audio id="correct-answer-audio" src="https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic_winner.mp3"></audio>
    <audio id="game-over-audio" src="https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic_over.mp3"></audio>

    <div id="game-container" class="w-full max-w-md mx-auto bg-white rounded-2xl shadow-xl p-6">
        <header class="text-center mb-4">
            <h1 class="text-2xl sm:text-3xl font-bold text-slate-800">4 Pics 1 Word</h1>
            <p class="text-slate-500">Capiz Edition</p>
            <div class="flex justify-between items-center mt-4 text-slate-600">
                <p>Level: <span id="level-display" class="font-bold text-indigo-600">1</span> </p>
                <p>Score: <span id="score-display" class="font-bold text-indigo-600">0</span></p>
                <div class="flex items-center gap-2">
                    <p>Time: <span id="timer-display" class="font-bold text-red-500">60</span>s</p>
                    <button id="hint-btn" class="bg-yellow-400 hover:bg-yellow-500 text-yellow-800 font-bold p-2 rounded-full h-8 w-8 flex items-center justify-center shadow-md transition-opacity relative">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                           <path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm-7.071 0a1 1 0 001.414 1.414l.707-.707a1 1 0 10-1.414-1.414l-.707.707zM10 16a1 1 0 100 2 1 1 0 000-2z" />
                        </svg>
                        <span id="hint-count-display" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center">1</span>
                    </button>
                </div>
            </div>
        </header>

        <main>
            <div id="image-grid" class="grid grid-cols-2 gap-2 mb-6 rounded-lg overflow-hidden"></div>
            <div id="answer-area" class="flex justify-center items-center gap-2 mb-6 h-12"></div>
            <div id="message-area" class="text-center h-6 mb-4 font-semibold"></div>
            <div id="letter-choices" class="grid grid-cols-7 gap-2"></div>
            <div class="mt-6 flex justify-center gap-4">
                <button id="next-level-btn" class="hidden bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-6 rounded-full shadow-md">
                    Next Level
                </button>
                <button id="quit-btn-bottom" class="bg-slate-500 hover:bg-slate-600 text-white font-bold py-2 px-6 rounded-full shadow-md">
                    Quit Game
                </button>
            </div>
        </main>
    </div>

    <div id="game-over-modal" class="modal-overlay hidden">
        <div class="modal-content w-11/12 max-w-sm">
            <h2 class="text-3xl font-bold text-red-600 mb-4">Game Over!</h2>
            <p class="text-slate-700 text-lg mb-2">Time's up!</p>
            <p class="text-slate-700 text-lg mb-4">
                The correct answer was: <span id="correct-answer-display" class="font-bold text-indigo-600"></span>
            </p>
            <p class="text-slate-700 text-lg">Your Final Score: <span id="final-score" class="font-bold">0</span></p>
            <button id="restart-btn" class="mt-6 bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-2 px-6 rounded-full shadow-md">
                Play Again
            </button>
        </div>
    </div>
    
    <div id="info-modal" class="modal-overlay hidden">
        <div class="modal-content w-11/12 max-w-sm">
            <h2 class="text-2xl font-bold text-indigo-600 mb-4">Did You Know?</h2>
            <p id="info-description" class="text-slate-700 text-left mb-6 text-base"></p>
            <button id="continue-btn" class="mt-4 bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-6 rounded-full shadow-md">
                Continue
            </button>
        </div>
    </div>


    <script>
        // --- GAME DATA (FULL LIST OF 50 QUESTIONS) ---
        const gameLevels = [
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/capizmap.png", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/logo.png", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/seafood.png", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/capizshell.jpg"], answer: "CAPIZ", description: "Capiz is a province in the Western Visayas region, known as the 'Seafood Capital of the Philippines' due to its abundant marine life." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/manuel.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/roxascity.png", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/bridge.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/bandstand.jpg"], answer: "ROXAS", description: "Roxas City is the capital of Capiz, named in honor of its most famous son, President Manuel Roxas, the first president of the independent Philippine Republic." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/bangus.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/alimango.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/talaba.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/hipon.jpg"], answer: "SEAFOOD", description: "The province's long coastline and rich fishing grounds make it a paradise for seafood lovers, offering fresh crabs, prawns, oysters, and more." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/stamonica.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/bell.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/stone.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/panay1.jpg"], answer: "CHURCH", description: "Capiz is home to many historical churches, including the Santa Monica Church in Panay, which houses the largest church bell in Asia." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/dance.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/colorful.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/colorful1.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/colorful2.jpg"], answer: "FESTIVAL", description: "Colorful festivals are a major part of Capiznon culture, like the Sinadya sa Halaran in Roxas City, a celebration of joy and thanksgiving." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/cave.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/cave1.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/cave2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/cave3.jpg"], answer: "CAVE", description: "The province has numerous caves waiting to be explored, such as the Suhot Cave in Dumalag, known for its cold spring and stunning rock formations." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/beach1.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/beach2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/beach3.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/beach4.jpg"], answer: "BEACH", description: "Baybay Beach in Roxas City is a popular destination for locals and tourists alike, famous for its gray sand and fresh seafood shacks." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/panay.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/panay1.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/bell.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/panay2.jpg"], answer: "PANAY", description: "Panay is a historic town in Capiz and the second-oldest Spanish settlement in the Philippines. It's where the famous giant bell is located." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/dumalag.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/dumalag1.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/dumalag2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/dumalag3.jpg"], answer: "DUMALAG", description: "Dumalag is a municipality known for its natural attractions, including the Suhot Cave and Cold Springs, a popular local tourist spot." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/ivisan.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/ivisan1.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/ivisan2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/ivisan3.jpg"], answer: "IVISAN", description: "Ivisan is a coastal town in Capiz that is a significant contributor to the province's fishing industry." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/jamindan.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/jamindan1.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/jamindan2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/jamindan3.jpg"], answer: "JAMINDAN", description: "Jamindan is home to Camp Macario Peralta, the headquarters of the Philippine Army's 3rd Infantry Division, making it a key military location in the Visayas." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/mambusao.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/mambusao1.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/mambusao2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/mambusao3.jpg"], answer: "MAMBUSAO", description: "Mambusao is an inland municipality known for its rich agricultural lands and the historic Mambusao Cathedral." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/maayon.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/maayon1.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/maayon2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/maayon3.jpg"], answer: "MAAYON", description: "Maayon is a town in Capiz that is rich in natural resources, including several cave systems and springs." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/panitan.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/panitan1.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/panitan2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/panitan3.jpg"], answer: "PANITAN", description: "Panitan is another key agricultural town in Capiz, contributing significantly to the province's rice production." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/pilar.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/pilar1.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/pilar2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/pilar3.jpg"], answer: "PILAR", description: "Pilar is a coastal town known for its historical sites like Balisong Cave, which served as a refuge for revolutionaries, and beautiful island attractions." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/ponte.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/ponte2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/ponte3.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/ponte4.jpg"], answer: "PONTEVEDRA", description: "Pontevedra is a municipality that plays a vital role in the province's aquaculture industry, particularly in prawn and fish farming." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/sapian.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/sapian2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/sapian3.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/sapian4.jpg"], answer: "SAPIAN", description: "Sapian is a coastal town famous for the 'Talahong Festival,' celebrating its abundance of oysters (talaba) and mussels (tahong)." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/sigma.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/sigma2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/sigma3.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/sigma4.jpg"], answer: "SIGMA", description: "Sigma is an inland municipality with a thriving agricultural economy, focused on rice, corn, and sugar production." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/tapaz.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/tapaz2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/tapaz3.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/tapaz4.jpg"], answer: "TAPAZ", description: "Tapaz is the largest municipality in Capiz by land area and is known for its beautiful mountain ranges and the Panay-Bukidnon indigenous community." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/cuartero.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/cuartero1.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/cuartero2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/cuartero3.jpg"], answer: "CUARTERO", description: "Cuartero is an agricultural town named after a Spanish friar, noted for its vast rice fields and inland fishponds." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/dao.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/dao1.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/dao2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/dao3.jpg"], answer: "DAO", description: "Dao is known as the 'Corn Capital of Capiz' due to its massive production of corn and related products." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/dumarao.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/dumarao2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/dumarao3.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/dumarao4.jpg"], answer: "DUMARAO", description: "Dumarao is a municipality with a rich history and is a center for agriculture in the southern part of Capiz." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/baybay.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/baybay2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/baybay3.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/baybay4.jpg"], answer: "BAYBAY", description: "Baybay is the local term for 'shore' or 'seaside.' Baybay Beach is a prominent landmark in Roxas City." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/mangrove.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/mangrove2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/mangrove3.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/mangrove4.jpg"], answer: "MANGROVE", description: "Capiz has extensive mangrove forests which serve as vital ecosystems for marine life and protect coastal communities. The Palina Greenbelt Ecopark is a popular mangrove tour destination." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/bella.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/bell2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/bell3.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/bell4.jpg"], answer: "BELL", description: "The Grand Bell of Panay Church is the largest of its kind in Asia. It weighs over 10 tons and was cast from 70 sacks of coins donated by the local people in 1878." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/kapis.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/kapis2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/kapis3.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/kapis4.jpg"], answer: "SHELL", description: "The Capiz shell ('kapis') is a translucent oyster shell used for making traditional window panes, lamps, and various handicrafts, which the province is named after." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/bridgea.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/bridgea2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/bridgea3.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/bridgea4.jpg"], answer: "BRIDGE", description: "Several iconic bridges span the Panay River in Roxas City, offering picturesque views and connecting different parts of the city center." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/museum.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/museum2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/museum3.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/museum4.jpg"], answer: "MUSEUM", description: "The Panubli-on Museum in Roxas City, housed in a historic water tank, showcases the rich history and cultural heritage of Capiz province." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/spanish.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/spanish2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/spanish3.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/spanish4.jpg"], answer: "SPANISH", description: "Capiz has a strong Spanish colonial influence, visible in its old churches, ancestral houses, and historical landmarks like the Panay Church and Roxas City Bridge." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/resort.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/resort2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/resort3.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/resort4.jpg"], answer: "RESORT", description: "From beachside resorts along Baybay Beach to inland resorts with pools and natural springs, Capiz offers various options for relaxation and leisure." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/river.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/river2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/river3.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/river4.jpg"], answer: "RIVER", description: "The Panay River is the longest river on Panay Island, flowing through Roxas City and providing livelihood and irrigation to many communities." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/hotel.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/hotel2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/hotel3.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/hotel4.jpg"], answer: "HOTEL", description: "Roxas City offers a range of hotels and accommodations for tourists and business travelers visiting the province of Capiz." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/island.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/island2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/island3.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/island4.jpg"], answer: "ISLAND", description: "Off the coast of Capiz are beautiful islands like Olotayan Island and Mantalinga Island, which are perfect for island hopping and snorkeling." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/falls.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/falls2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/falls3.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/falls4.jpg"], answer: "WATERFALL", description: "The mountainous areas of Capiz, such as in Tapaz and Jamindan, are home to several scenic waterfalls, offering a refreshing escape for nature lovers." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/sinadya.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/sinadya2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/sinadya3.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/sinadya4.jpg"], answer: "SINADYA", description: "'Sinadya' is a Hiligaynon word for 'joy' and is the name of the grand festival in Roxas City, 'Sinadya sa Halaran.'" },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/capiztahan.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/capiztahan2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/capiztahan3.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/capiztahan4.jpg"], answer: "CAPIZTAHAN", description: "Capiztahan is the founding anniversary celebration of the province of Capiz, showcasing its culture, products, and history." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/tourism.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/tourism2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/tourism3.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/tourism4.jpg"], answer: "TOURISM", description: "Tourism is a growing industry in Capiz, attracting visitors with its fresh seafood, historical landmarks, natural caves, and pristine beaches." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/bangus.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/bangus2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/bangus3.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/bangus4.jpg"], answer: "FISHING", description: "Fishing is a primary livelihood for thousands of families in Capiz, making it the seafood capital it is today." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/market.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/market2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/market3.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/market4.jpg"], answer: "MARKET", description: "The Teodoro Arcenas Trade Center (TATC) in Roxas City is the main public market where you can buy the freshest seafood, local produce, and native delicacies." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/province.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/province2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/province3.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/province4.jpg"], answer: "PROVINCE", description: "Capiz is one of the five provinces located on Panay Island in the Western Visayas region of the Philippines." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/legend.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/legend2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/legend3.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/legend4.jpg"], answer: "LEGEND", description: "Capiz is famous in Filipino folklore and legend, often associated with tales of the 'aswang,' though locals prefer to highlight the province's natural beauty and rich culture." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/travel.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/travel2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/travel3.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/travel4.jpg"], answer: "TRAVEL", description: "Travel to Capiz is accessible via the Roxas Airport, which has regular flights from Manila, making it an easy destination for tourists." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/church.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/church2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/church3.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/church4.jpg"], answer: "CHURCH", description: "The Immaculate Conception Metropolitan Cathedral in Roxas City is another significant religious landmark, serving as the seat of the Archdiocese of Capiz." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/food.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/food2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/food3.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/food4.jpg"], answer: "FOOD", description: "Beyond seafood, Capiz offers delicious local food and delicacies like 'suman', 'ibus', and various rice cakes that are popular snacks." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/history.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/history2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/history3.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/history4.jpg"], answer: "HISTORY", description: "Capiz has a rich history, from being one of the earliest Spanish settlements to being the birthplace of a Philippine president." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/native.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/native2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/native3.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/native4.jpg"], answer: "NATIVE", description: "The mountainous region of Tapaz is home to the Panay-Bukidnon, a native indigenous group known for their unique 'Binukot' tradition and epic chants." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/pres.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/pres2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/pres3.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/pres4.jpg"], answer: "PRESIDENT", description: "Capiz takes pride in being the birthplace of President Manuel Roxas, whose legacy is honored throughout the province, especially in its capital city." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/farm.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/farm2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/farm3.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/farm4.jpg"], answer: "FARMING", description: "Besides fishing, farming is a major industry in Capiz, with vast lands dedicated to rice, corn, and sugar cane cultivation." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/sugpo.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/sugpo2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/sugpo3.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/sugpo4.jpg"], answer: "PRAWN", description: "Prawns, or 'sugpo', are a high-value product of Capiz's thriving aquaculture industry, farmed in brackish water ponds." },
            { images: ["https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/talabaa.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/talabaa2.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/talabaa3.jpg", "https://raw.githubusercontent.com/capturecapiz/capturecapiz/main/html/assets/img/4pic/talabaa4.jpg"], answer: "OYSTER", description: "Oysters, or 'talaba', are one of the most famous and affordable seafood delicacies in Capiz, often enjoyed fresh or baked." }
        ];

        // --- GAME STATE ---
        let currentLevelIndex = 0;
        let score = 0;
        let timeLeft = 60;
        let timerInterval = null;
        let shuffledLevels = [];
        let hintCount = 1;

        // --- DOM ELEMENTS ---
        const levelDisplay = document.getElementById('level-display');
        const scoreDisplay = document.getElementById('score-display');
        const timerDisplay = document.getElementById('timer-display');
        const imageGrid = document.getElementById('image-grid');
        const answerArea = document.getElementById('answer-area');
        const letterChoices = document.getElementById('letter-choices');
        const messageArea = document.getElementById('message-area');
        const nextLevelBtn = document.getElementById('next-level-btn');
        const hintBtn = document.getElementById('hint-btn');
        const hintCountDisplay = document.getElementById('hint-count-display');
        const gameContainer = document.getElementById('game-container');
        const gameOverModal = document.getElementById('game-over-modal');
        const restartBtn = document.getElementById('restart-btn');
        const finalScoreDisplay = document.getElementById('final-score');
        const correctAnswerDisplay = document.getElementById('correct-answer-display');
        const backgroundAudio = document.getElementById('background-audio');
        const correctAnswerAudio = document.getElementById('correct-answer-audio');
        const gameOverAudio = document.getElementById('game-over-audio');
        const infoModal = document.getElementById('info-modal');
        const infoDescription = document.getElementById('info-description');
        const continueBtn = document.getElementById('continue-btn');
        const quitBtnBottom = document.getElementById('quit-btn-bottom');

        // --- FUNCTIONS ---

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }
        
        function startNewGame() {
            gameOverAudio.pause();
            gameOverAudio.currentTime = 0;
            currentLevelIndex = 0;
            score = 0;
            hintCount = 1;
            gameOverModal.classList.add('hidden');
            
            const allLevelsShuffled = [...gameLevels];
            shuffleArray(allLevelsShuffled);
            shuffledLevels = allLevelsShuffled.slice(0, 15);
            
            loadLevel();

            backgroundAudio.currentTime = 0;
            backgroundAudio.play().catch(e => console.log("Autoplay blocked by browser."));
        }

        function startNewTimer() {
            clearInterval(timerInterval);
            timeLeft = 60;
            timerDisplay.textContent = timeLeft;
            timerInterval = setInterval(updateTimer, 1000);
        }
        
        function updateHintDisplay() {
            hintCountDisplay.textContent = hintCount;
            hintBtn.disabled = hintCount <= 0;
            hintBtn.classList.toggle('opacity-50', hintCount <= 0);
            hintBtn.classList.toggle('cursor-not-allowed', hintCount <= 0);
        }

        function loadLevel() {
            if (currentLevelIndex >= shuffledLevels.length) {
                clearInterval(timerInterval);
                gameContainer.innerHTML = `
                    <div class="text-center">
                        <h2 class="text-3xl font-bold text-green-600 mb-4">Congratulations!</h2>
                        <p class="text-slate-700 text-lg mb-2">You have completed all 15 levels.</p>
                        <p class="text-slate-700 text-lg">Final Score: <span class="font-bold">${score}</span></p>
                        <button onclick="startNewGame()" class="mt-6 bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-2 px-6 rounded-full shadow-md">Play Again</button>
                    </div>
                `;
                return;
            }
            
            startNewTimer();
            updateHintDisplay();

            const levelData = shuffledLevels[currentLevelIndex];
            levelDisplay.textContent = `${currentLevelIndex + 1} / ${shuffledLevels.length}`;
            scoreDisplay.textContent = score;
            messageArea.textContent = '';
            nextLevelBtn.classList.add('hidden');

            imageGrid.innerHTML = '';
            levelData.images.forEach(src => {
                const imgContainer = document.createElement('div');
                imgContainer.className = 'aspect-square image-placeholder rounded-md';
                imgContainer.style.backgroundImage = `url(${src})`;
                imgContainer.onerror = function() { this.style.backgroundImage = `url('https://placehold.co/200x200/e2e8f0/4a5568?text=Image+Error')`; };
                imageGrid.appendChild(imgContainer);
            });

            answerArea.innerHTML = '';
            levelData.answer.split('').forEach((_, i) => {
                const box = document.createElement('div');
                box.className = 'answer-box w-10 h-12 sm:w-12 sm:h-14 bg-slate-200 rounded-md flex items-center justify-center text-2xl font-bold text-slate-700 cursor-pointer';
                box.dataset.index = i;
                box.addEventListener('click', handleAnswerBoxClick);
                answerArea.appendChild(box);
            });

            const answerLetters = levelData.answer.split('');
            const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            let choiceLetters = [...answerLetters];
            while (choiceLetters.length < 14) {
                const randomLetter = alphabet[Math.floor(Math.random() * alphabet.length)];
                if (choiceLetters.filter(l => l === randomLetter).length < 2) {
                     choiceLetters.push(randomLetter);
                }
            }
            shuffleArray(choiceLetters);

            letterChoices.innerHTML = '';
            choiceLetters.forEach(letter => {
                const btn = document.createElement('button');
                btn.className = 'letter-btn bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-2 rounded-md';
                btn.textContent = letter;
                btn.addEventListener('click', () => selectLetter(btn));
                letterChoices.appendChild(btn);
            });
        }

        function handleAnswerBoxClick(event) {
            const box = event.currentTarget;
            if (!box.classList.contains('hint-revealed')) {
                returnLetter(box);
            }
        }

        function selectLetter(letterBtn) {
            const emptyBox = Array.from(document.querySelectorAll('.answer-box')).find(box => !box.textContent);
            if (emptyBox) {
                emptyBox.textContent = letterBtn.textContent;
                letterBtn.style.visibility = 'hidden';
                checkAnswer();
            }
        }

        function returnLetter(answerBox) {
            if (!answerBox.textContent) return;
            const letterToReturn = answerBox.textContent;
            answerBox.textContent = '';
            const hiddenButton = Array.from(document.querySelectorAll('.letter-btn')).find(btn => btn.textContent === letterToReturn && btn.style.visibility === 'hidden');
            if (hiddenButton) {
                hiddenButton.style.visibility = 'visible';
            }
        }
        
        function resetAnswer() {
            document.querySelectorAll('.answer-box').forEach(box => {
                if (box.textContent && !box.classList.contains('hint-revealed')) {
                    returnLetter(box);
                }
            });
        }

        function checkAnswer() {
            const answerBoxes = document.querySelectorAll('.answer-box');
            let currentGuess = Array.from(answerBoxes).map(box => box.textContent).join('');
            
            if (currentGuess.length === shuffledLevels[currentLevelIndex].answer.length) {
                if (currentGuess === shuffledLevels[currentLevelIndex].answer) {
                    clearInterval(timerInterval);
                    correctAnswerAudio.play();
                    messageArea.textContent = 'Correct!';
                    messageArea.className = 'text-center h-6 mb-4 font-semibold text-green-500';
                    score += 10;
                    if (hintCount < 6) hintCount++;
                    updateHintDisplay();
                    scoreDisplay.textContent = score;
                    answerArea.classList.add('correct');
                    
                    setTimeout(() => {
                        answerArea.classList.remove('correct');
                        showInfoModal();
                    }, 1000);

                } else {
                    messageArea.textContent = 'Try Again!';
                    messageArea.className = 'text-center h-6 mb-4 font-semibold text-red-500';
                    answerArea.classList.add('incorrect');
                    letterChoices.style.pointerEvents = 'none';
                    setTimeout(() => {
                        answerArea.classList.remove('incorrect');
                        messageArea.textContent = '';
                        resetAnswer();
                        letterChoices.style.pointerEvents = 'auto';
                    }, 1000);
                }
            }
        }
        
        function showInfoModal() {
            const levelData = shuffledLevels[currentLevelIndex];
            infoDescription.textContent = levelData.description || "No description available for this topic.";
            infoModal.classList.remove('hidden');
        }

        function giveHint() {
            if (hintCount <= 0) return;

            const correctAnswer = shuffledLevels[currentLevelIndex].answer;
            const answerBoxes = document.querySelectorAll('.answer-box');
            let hintIndex = Array.from(answerBoxes).findIndex((box, i) => box.textContent !== correctAnswer[i]);

            if (hintIndex === -1) return;

            hintCount--;
            updateHintDisplay();

            const correctLetter = correctAnswer[hintIndex];
            const targetBox = answerBoxes[hintIndex];

            if (targetBox.textContent) returnLetter(targetBox);

            const buttonToPress = Array.from(document.querySelectorAll('.letter-btn')).find(btn => btn.textContent === correctLetter && btn.style.visibility !== 'hidden');
            
            if (buttonToPress) {
                selectLetter(buttonToPress);
                targetBox.classList.add('hint-revealed');
            }
            checkAnswer();
        }

        function updateTimer() {
            timeLeft--;
            timerDisplay.textContent = timeLeft;
            if (timeLeft <= 0) {
                clearInterval(timerInterval);
                showGameOverModal();
            }
        }

        function showGameOverModal() {
            backgroundAudio.pause();
            gameOverAudio.play();
            finalScoreDisplay.textContent = score;
            correctAnswerDisplay.textContent = shuffledLevels[currentLevelIndex].answer;
            gameOverModal.classList.remove('hidden');
        }

        // --- EVENT LISTENERS ---
        nextLevelBtn.addEventListener('click', () => {
            currentLevelIndex++;
            loadLevel();
        });

        hintBtn.addEventListener('click', giveHint);
        restartBtn.addEventListener('click', startNewGame);
        
        quitBtnBottom.addEventListener('click', () => {
            window.location.href = 'index_1.html';
        });

        continueBtn.addEventListener('click', () => {
            infoModal.classList.add('hidden');
            nextLevelBtn.classList.remove('hidden');
        });

        // --- INITIALIZE GAME ---
        document.addEventListener('DOMContentLoaded', () => {
            document.body.addEventListener('click', () => {
                backgroundAudio.play().catch(e => console.log("Autoplay blocked. Waiting for user interaction."));
            }, { once: true });
            
            startNewGame();
        });

    </script>
</body>
</html>
