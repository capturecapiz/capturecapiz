/* 
* rwdImageMaps jQuery plugin v1.6
*
* Allows image maps to be used in a responsive design by recalculating the area coordinates to match the actual image size on load and window.resize
*
* Copyright (c) 2016 Matt Stow
* https://github.com/stowball/jQuery-rwdImageMaps
* http://mattstow.com
* Licensed under the MIT license
*/
(function($) {
  $.fn.rwdImageMaps = function() {
    var $img = this;

    var resizeImageMap = function() {
      $img.each(function() {
        var $this = $(this);
        if (typeof $this.attr("usemap") === "undefined") return;

        $("<img />").on('load', function() {
          var originalWidth = $this.attr("width") || this.width;
          var originalHeight = $this.attr("height") || this.height;
          var newWidth = $this.width() / 100;
          var newHeight = $this.height() / 100;
          var mapName = $this.attr("usemap").replace("#", "");

          $('map[name="' + mapName + '"]').find("area").each(function() {
            var $area = $(this);
            if (!$area.data("coords")) {
              $area.data("coords", $area.attr("coords"));
            }

            var coords = $area.data("coords").split(",");
            var newCoords = coords.map(function(coord, index) {
              return parseInt(((index % 2 === 0 ? coord / originalWidth : coord / originalHeight) * 100) * (index % 2 === 0 ? newWidth : newHeight));
            });

            $area.attr("coords", newCoords.toString());
          });
        }).attr("src", $this.attr("src"));
      });
    };

    $(window).resize(resizeImageMap).trigger("resize");

    return this;
  };
})(jQuery);
